<!-- 
 This page/panel shows the result of the simulation.

 Made by ds@randi2.de  

 This file is part of RANDI2.
 RANDI2 is free software: you can redistribute it and or modify it under the
 terms of the GNU General Public License as published by the Free Software
 Foundation, either version 3 of the License, or (at your option) any later
 version.
 RANDI2 is distributed in the hope that it will be useful, but WITHOUT ANY
 WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
 A PARTICULAR PURPOSE. See the GNU General Public License for more details.
 You should have received a copy of the GNU General Public License along with
 RANDI2. If not, see http://www.gnu.org/licenses/.
 -->
 <div>
<ice:dataTable id="simResultTable" border="1"
	value="#{simulationHandler.simulationResults}" var="result"
	width="550px" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ice="http://www.icesoft.com/icefaces/component">
	<ice:column id="column0">
		<ice:outputText value="#{result.algorithmDescription}" />
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.algo']}" />
		</f:facet>
	</ice:column>
	<ice:column id="column1">
		<ice:outputText value="#{result.amountRuns}" />
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.runs']}" />
		</f:facet>
	</ice:column>
	<ice:column id="column2">
		<ice:outputText value="#{result.duration}" />
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.time']}"/>
		</f:facet>
	</ice:column>
	<ice:column id="column3">
		<ice:outputLabel value="#{result.marginalBalanceMinRounded}" />
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.minMarginalBal']}"/>
		</f:facet>
	</ice:column>
	<ice:column id="column4">
		<ice:outputLabel value="#{result.marginalBalanceMeanRounded}" />
		<f:facet name="header">
			<ice:outputLabel
				value="#{labels['pages.simulation.meanMarginalBal']}"/>
		</f:facet>
	</ice:column>
	<ice:column id="column5">
		<ice:outputLabel value="#{result.marginalBalanceMaxRounded}" />
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.maxMarginalBal']}"/>
		</f:facet>
	</ice:column>
</ice:dataTable>
<h:dataTable id="simResultDetailsTable" border="1"
	value="#{simulationHandler.simulationResults}" var="result"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ice="http://www.icesoft.com/icefaces/component">
	<h:column id="column0">
		<f:facet name="header">
			<h:outputLabel value="#{labels['pages.simulation.details']}" />
		</f:facet>
		<h:outputText value="#{result.algorithmDescription}" />

		<ice:dataTable id="simResultDetailsArmTable" border="1"
			value="#{result.simResultArms}" var="simArm" width="640px">

			<ice:column id="column0">
				<ice:outputLabel value="#{simArm.arm.name }" />
				<f:facet name="header">
					<ice:outputLabel value="#{labels['pages.simulation.arm']}" />
				</f:facet>
			</ice:column>
			<ice:column id="column1">
				<ice:outputLabel value="#{simArm.min }" />
				<f:facet name="header">
					<ice:outputLabel value="#{labels['pages.simulation.min']}" />
				</f:facet>
			</ice:column>
			<ice:column id="column11">
				<ice:outputLabel value="#{simArm.minPercentString }" />
				<f:facet name="header">
					<ice:outputLabel value="#{labels['pages.simulation.minPerCent']}" />
				</f:facet>
			</ice:column>
			<ice:column id="column2">
				<ice:outputLabel value="#{simArm.max }" />
				<f:facet name="header">
					<ice:outputLabel value="#{labels['pages.simulation.max']}" />
				</f:facet>
			</ice:column>
			<ice:column id="column22">
				<ice:outputLabel value="#{simArm.maxPercentString}"/>
				<f:facet name="header">
					<ice:outputLabel value="#{labels['pages.simulation.maxPerCent']}" />
				</f:facet>
			</ice:column>
			<ice:column id="column3">
				<ice:outputLabel value="#{simArm.mean }" />
				<f:facet name="header">
					<ice:outputLabel value="#{labels['pages.simulation.mean']}" />
				</f:facet>
			</ice:column>
			<ice:column id="column4">
				<ice:outputLabel value="#{simArm.median }" />
				<f:facet name="header">
					<ice:outputLabel value="#{labels['pages.simulation.median']}" />
				</f:facet>
			</ice:column>
		</ice:dataTable>
	</h:column>
</h:dataTable>
<br />
<ice:panelGrid columns="2" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ice="http://www.icesoft.com/icefaces/component">
	<ice:outputLabel value="#{labels['pages.simulation.order']}" />
	<ice:selectOneRadio id="SlctCompTyp"
		value="#{simulationHandler.selectedOrder}" partialSubmit="true">
		<f:selectItems id="SlctcompTypeItms"
			value="#{simulationHandler.orderItems}" />
	</ice:selectOneRadio>
</ice:panelGrid>
<ice:outputText value="A - #{labels['pages.simulation.subgroupAlgorithm']}, S -  #{labels['pages.simulation.subgroupSubgroup']} T - T #{labels['pages.simulation.subgroupTreatmentArm']} " xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ice="http://www.icesoft.com/icefaces/component"/>
	
<ice:dataTable id="simResultStrataDetailsTableSAT" border="1"
	value="#{simulationHandler.allStrataResults}" var="strataResult"
	width="700px" rendered="#{simulationHandler.sat}" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ice="http://www.icesoft.com/icefaces/component">
	<ice:column id="column0" groupOn="#{strataResult.strataId}">
		<f:facet name="header">
			<ice:outputLabel value= "#{labels['pages.simulation.subgroup']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.strataName}" />
	</ice:column>
	<ice:column id="column1" groupOn="#{strataResult.algorithmName}">
		<f:facet name="header">
			<ice:outputLabel value = "#{labels['pages.simulation.algo']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.algorithmName}" />
	</ice:column>
	<ice:column id="column2" groupOn="#{strataResult.treatmentName}">
		<f:facet name="header">
			<ice:outputLabel value ="#{labels['pages.simulation.arm']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.treatmentName}" />
	</ice:column>
	<ice:column id="column3">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.minPatCount']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.minCount}" />
	</ice:column>
	<ice:column id="column4">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.meanPatCount']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.mean}" />
	</ice:column>
	<ice:column id="column5">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.maxPatCount']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.maxCount}" />
	</ice:column>
</ice:dataTable>

<ice:dataTable id="simResultStrataDetailsTableSTA" border="1"
	value="#{simulationHandler.allStrataResults}" var="strataResult"
	width="700px" rendered="#{simulationHandler.sta}" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ice="http://www.icesoft.com/icefaces/component">
	<ice:column id="column0" groupOn="#{strataResult.strataId}">
		<f:facet name="header">
			<ice:outputLabel value= "#{labels['pages.simulation.subgroup']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.strataName}" />
	</ice:column>
	<ice:column id="column2" groupOn="#{strataResult.treatmentName}">
		<f:facet name="header">
			<ice:outputLabel value ="#{labels['pages.simulation.arm']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.treatmentName}" />
	</ice:column>
	<ice:column id="column1" groupOn="#{strataResult.algorithmName}">
		<f:facet name="header">
			<ice:outputLabel  value="#{labels['pages.simulation.algo']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.algorithmName}" />
	</ice:column>
	<ice:column id="column3">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.minPatCount']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.minCount}" />
	</ice:column>
	<ice:column id="column4">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.meanPatCount']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.mean}" />
	</ice:column>
	<ice:column id="column5">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.maxPatCount']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.maxCount}" />
	</ice:column>
</ice:dataTable>

<ice:dataTable id="simResultStrataDetailsTableATS" border="1"
	value="#{simulationHandler.allStrataResults}" var="strataResult"
	width="700px" rendered="#{simulationHandler.ats}" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ice="http://www.icesoft.com/icefaces/component">
	<ice:column id="column1" groupOn="#{strataResult.algorithmName}">
		<f:facet name="header">
			<ice:outputLabel  value="#{labels['pages.simulation.algo']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.algorithmName}" />
	</ice:column>
	<ice:column id="column2" groupOn="#{strataResult.treatmentName}">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.arm']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.treatmentName}" />
	</ice:column>
	<ice:column id="column0" groupOn="#{strataResult.strataId}">
		<f:facet name="header">
			<ice:outputLabel value= "#{labels['pages.simulation.subgroup']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.strataName}" />
	</ice:column>
	<ice:column id="column3">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.minPatCount']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.minCount}" />
	</ice:column>
	<ice:column id="column4">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.meanPatCount']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.mean}" />
	</ice:column>
	<ice:column id="column5">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.maxPatCount']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.maxCount}" />
	</ice:column>
</ice:dataTable>

<ice:dataTable id="simResultStrataDetailsTableAST" border="1"
	value="#{simulationHandler.allStrataResults}" var="strataResult"
	width="700px" rendered="#{simulationHandler.ast}" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ice="http://www.icesoft.com/icefaces/component">
	<ice:column id="column1" groupOn="#{strataResult.algorithmName}">
		<f:facet name="header">
			<ice:outputLabel  value="#{labels['pages.simulation.algo']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.algorithmName}" />
	</ice:column>
	<ice:column id="column0" groupOn="#{strataResult.strataId}">
		<f:facet name="header">
			<ice:outputLabel value= "#{labels['pages.simulation.subgroup']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.strataName}" />
	</ice:column>
	<ice:column id="column2" groupOn="#{strataResult.treatmentName}">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.arm']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.treatmentName}" />
	</ice:column>
	<ice:column id="column3">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.minPatCount']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.minCount}" />
	</ice:column>
	<ice:column id="column4">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.meanPatCount']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.mean}" />
	</ice:column>
	<ice:column id="column5">
		<f:facet name="header">
			<ice:outputLabel value="#{labels['pages.simulation.maxPatCount']}"/>
		</f:facet>
		<ice:outputLabel value="#{strataResult.maxCount}" />
	</ice:column>
</ice:dataTable>
<ice:panelGrid columns="4" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ice="http://www.icesoft.com/icefaces/component">
	<ice:outputResource id="csv-button"
		rendered="#{simulationHandler.collectRawData}" label="export raw data"
		resource="#{simulationHandler.exportSimulationRawData}"
		mimeType="text/comma-separated-values" fileName="rawData.csv"
		type="button" />
	<ice:outputResource id="html-button"
		label="#{labels['pages.simulation.exportResults']}"
		resource="#{simulationHandler.exportSimulationResults}"
		mimeType="text/html" fileName="simulationResult.html" type="button" />
	<ice:commandButton value="#{labels['pages.simulation.repeat']}"
		action="#{simulationHandler.simTrial}" />
	<ice:commandButton value="#{labels['pages.simulation.changeConf']}"
		actionListener="#{randi2Page.simulateTrialOnlyChange}" />
</ice:panelGrid>
</div>